[tools]
go = "1.25"
golangci-lint = "2.5.0"
goreleaser = "2.12.5"

[tasks.default]
run = [
    { task = "build" },
    { task = "test" },
]

[tasks.build]
run = """
#!/usr/bin/env bash

goreleaser build \
  --snapshot --skip=before --clean \
  --single-target -o ./dist/gostore
"""

[tasks.modules]
run = "go mod tidy"

[tasks.test]
depends = [ "test:*" ]

[tasks."test:go-test"]
# exclude tests from ./cmd/tests
run = "go test $(go list ./... | grep -v '/cmd/tests')"

[tasks."test:lint"]
run = "golangci-lint run"
